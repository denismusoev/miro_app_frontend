# Документация по управлению правами пользователей

## Общее описание

Система управления правами в приложении реализует ролевую модель доступа (RBAC) с различными уровнями прав для проектов и досок. Каждый уровень доступа предоставляет определенный набор возможностей.

Доступные уровни прав (в порядке убывания):
1. **OWNER** - владелец, имеет полные права
2. **ADMIN** - администратор, имеет права на управление доступом
3. **WRITE** - редактор, может изменять контент
4. **READ** - читатель, может только просматривать
5. **DENIED** - запрещен доступ

## Реализованные компоненты

Система управления правами включает следующие основные компоненты:

1. **API функции** - `src/utils/api.js`:
   - Управление правами для проектов и досок
   - Получение и обновление прав пользователей

2. **Модели данных** - `src/model/PermissionModels.js`:
   - Определения уровней доступа (`AccessLevel`)
   - DTO объекты для передачи данных о правах (`ProjectPermissionUpdateDto`, `BoardPermissionUpdateDto`)

3. **UI компоненты**:
   - `src/components/ProjectPermissions.jsx` - управление правами проекта
   - `src/components/BoardPermissions.jsx` - управление правами доски

4. **Интеграция**:
   - На странице проекта добавлена вкладка "Управление доступом"
   - На странице доски добавлена вкладка "Доступ" и кнопка в тулбаре

## Функциональные возможности

### Для проектов

1. **Просмотр участников проекта**:
   - Список всех пользователей с доступом к проекту
   - Отображение уровня доступа каждого пользователя
   - Индикация владельца проекта

2. **Управление правами**:
   - Добавление новых пользователей (по email)
   - Изменение уровня доступа существующих пользователей
   - Удаление пользователей из проекта

### Для досок

1. **Просмотр участников доски**:
   - Список всех пользователей с доступом к доске
   - Отображение уровня доступа каждого пользователя
   - Индикация владельца доски

2. **Управление правами**:
   - Добавление новых пользователей (по email)
   - Изменение уровня доступа существующих пользователей
   - Удаление пользователей из доски

## Ограничения доступа

1. **Проверка прав пользователя**:
   - При загрузке страницы проверяются права текущего пользователя
   - API запросы защищены проверкой прав на сервере

2. **Ограничения UI**:
   - Функции управления правами доступны только для владельцев и администраторов
   - Пользователи с правами READ могут только просматривать список участников
   - Пользователи с правами DENIED не имеют доступа к ресурсу

3. **Системные ограничения**:
   - Владелец не может быть удален или понижен в правах
   - Пользователь не может изменить свои права на проекте/доске

## Взаимодействие с сервером

### REST API эндпоинты

#### Проекты
- `GET /api/projects/{projectId}/permissions` - получение списка участников проекта
- `GET /api/projects/{projectId}/permissions/current` - получение прав текущего пользователя
- `POST /api/projects/{projectId}/permissions` - добавление пользователя (по email)
- `PUT /api/projects/{projectId}/permissions` - обновление прав пользователя (по email)
- `DELETE /api/projects/{projectId}/permissions?email={email}` - удаление пользователя из проекта

#### Доски
- `GET /api/boards/{boardId}/permissions` - получение списка участников доски
- `GET /api/boards/{boardId}/permissions/current` - получение прав текущего пользователя
- `POST /api/boards/{boardId}/permissions` - добавление пользователя (по email)
- `PUT /api/boards/{boardId}/permissions` - обновление прав пользователя (по email)
- `DELETE /api/boards/{boardId}/permissions?email={email}` - удаление пользователя из доски

### Ошибки сервера

Возможные ответы сервера в случае ошибок:
- `400 Bad Request` - некорректные данные запроса
- `403 Forbidden` - недостаточно прав для выполнения операции
- `404 Not Found` - проект/доска/пользователь не найден
- `409 Conflict` - пользователь уже имеет доступ с указанными правами
- `500 Internal Server Error` - ошибка сервера

## Дальнейшие улучшения

Возможные расширения функциональности управления правами:

1. **Поиск пользователей** - реализация автоподсказок при вводе email
2. **Групповые права** - возможность назначать права группам пользователей
3. **Делегирование прав** - временная передача прав другому пользователю
4. **Аудит действий** - логирование изменений в правах доступа
5. **Более гранулярные права** - разделение прав на более детальные операции
6. **Наследование прав** - автоматическое наследование прав с проекта на доски

## Заключение

Реализованная система управления правами предоставляет гибкие возможности для контроля доступа к проектам и доскам. Ролевая модель с несколькими уровнями доступа обеспечивает необходимый баланс между безопасностью и удобством использования. 